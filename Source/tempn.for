      subroutine tempn(z,tau,w,om,td,p,fa,fs,ap,tn,tb,t120,s)
      dimension p(12),g(41),gs(11),gt120(5)
      data
     *g
     */ 1.041e03, 0.      , 2.599e-3, 3.333e-2, 1.198e-3,-5.374e-6,
     *  3.197e-3, 5.620e-3, 5.582e-3, 5.929e-3, 9.056e-3, 5.572e-1,
     *  1.837e-1, 1.125e-2,-2.696e01, 6.276e-3, 7.290e-3, 9.902e01,
     * -1.298e-1,-2.522e-2,-1.143e01,-1.611e-2, 3.213e01,-1.239e-1,
     *  4.381e-3, 0.      , 1.123e-2, 1.176e-2,-1.094e-1, 2.097e-3,
     *  0.      ,-6.750e-3,-6.396e-3,-3.743e-3, 0.      , 3.977e-3,
     *  5.432e-3, 0.      , 1.339e-3, 2.873e-4, 8.585e-4/,
     *gt120
     */ 3.860e02, 1.300e-2, 9.902e01,-3.700e-2,-1.143e01/,
     *gs
     */ 2.548e-2, 1.732e-1,-3.731e-2, 8.168e-3, 3.570e-2,-1.500e-2,
     *  5.512e-3, 2.218e-2, 4.772e-3, 3.744e-2,-1.001e-2/
      df=fa-fs
      dfs=fs-150.
      ap4=ap-4.
      t120=gt120(1)*(1.+gt120(2)*cos(om*om*(td-gt120(3)))+
     *gt120(4)*p(1)*cos(om*(td-gt120(5))))
      wt=w*tau
      wt2=wt+wt
      wt3=3.*wt
      cwt=cos(wt)
      swt=sin(wt)
      s=gs(1)*(1.+(gs(2)*p(5)+gs(3)*p(7)+gs(4)*p(8))*cwt+
     *(gs(5)*p(5)+gs(6)*p(7)+gs(7)*p(8))*swt+(gs(8)*p(9)+
     *gs(9)*p(11))*cos(wt2)+(gs(10)*p(9)+gs(11)*p(11))*sin(wt2))
      gk12=g(12)
      da=ap4+(g(13)-1.)*(ap4+(exp(-gk12*ap4)-1.)/gk12)
      arg1=cos(om*(td-g(21)))
      arg2=1.+g(9)*dfs
      om2=om+om
      gg=1.+g(3)*p(2)+g(4)*p(4)+g(2)*p(1)+g(5)*df+g(6)*df*df+
     *g(7)*dfs+(g(10)+g(11)*p(2))*da+g(14)*cos(om*(td-g(15)))+
     *(g(16)+g(17)*p(2))*cos(om2*(td-g(18)))+(g(19)*p(1)+g(20)*
     *p(3))*(1.+g(8)*dfs)*arg1
      gg=gg+g(22)*p(1)*cos(om2*(td-g(23)))
      gg=gg+(g(24)*p(5)+g(25)*p(7)+g(26)*p(8)+(g(27)*p(5)+g(28)*
     *p(6))*arg1)*arg2*cwt
      gg=gg+(g(29)*p(5)+g(30)*p(7)+g(31)*p(8)+(g(32)*p(5)+g(33)*
     *p(6))*arg1)*arg2*swt
      gg=gg+(g(34)*p(9)+g(35)*p(11)+g(36)*p(10)*arg1)*arg2*cos(wt2)
      gg=gg+(g(37)*p(9)+g(38)*p(11)+g(39)*p(10)*arg1)*arg2*sin(wt2)
      gg=gg+p(12)*arg2*(g(40)*cos(wt3)+g(41)*sin(wt3))
      tb=g(1)*gg
      tn=tb-(tb-t120)*exp(s*(120.-z))
      return
      end
